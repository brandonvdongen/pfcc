local password = "bob"
local attempts = 2
redstone = false

text = "nil"


local function cls()
term.clear()
term.setCursorPos(1,1)
end

local pullEvent = os.pullEvent
os.pullEvent = os.pullEventRaw

function security()
cls()
print("loading...")

sleep(1)
	for i=1,attempts do 
	cls()
	print("admin mode")
	print("attempts left: "..tostring(attempts-i))
	write("password: ")
	text = read("*")
		if text == password then
		print("password accepted")
		sleep(1)
		cls()
		print("FoxOS 1.0")
		os.pullEvent = pullEvent
		return "succes"
		else
		print("password denied")
		sleep(1)
		cls()
		end
	end
	os.pullEvent = pullEvent
	return "fail"
end


while true do
	local CountdownTimer = os.startTimer(1)
	while true do
		local e,p1 = os.pullEventRaw()
		if e=="terminate" then
			if security() == "succes" then
			return
			else
			break
			end
		elseif e=="timer" and p1==CountdownTimer then		  
			  break --End the loop
		elseif e=="key" and p1==28 then
			
		local x, y = term.getCursorPos()
		term.setCursorPos(1,y-1)
		term.clearLine()
		write("command: ")
		text = read()
		break
		end
	end
cls()
print("water flow: "..tostring(not redstone))
	if text == "power up" then
	print("powering up")
	rs.setOutput("top",false)
	redstone = false
	elseif text == "power down" then
	print("powering down")
	rs.setOutput("top",true)
	redstone=true
	elseif text == "logout" then
		if security() == "succes" then
		return
		end	
	elseif text == "nil" then
	print("press enter to enter command")
	end
	text = "nil"
end